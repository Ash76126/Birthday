<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Final Letter üéÇüíù</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">

  <style>
    /* Page 3 base styles */
    body.page3 {
      background: linear-gradient(135deg, #12002f 0%, #000 40%, #12002f 100%) !important;
      background-size: 400% 400% !important;
      animation: gradientShift 10s ease infinite !important;
      color: #fff !important;
      font-family: 'Poppins', sans-serif !important;
      padding: 1rem !important;
      overflow-y: auto !important;
      overflow-x: hidden !important;
      height: 100vh !important;
      width: 100vw !important;
      display: flex !important;
      align-items: flex-start !important;
      justify-content: center !important;
      padding-top: 1rem !important;
    }

    .letter-wrapper {
      max-width: 500px !important;
      width: 95% !important;
      padding: 1.5rem 1rem !important;
      background: rgba(255,255,255,0.08) !important;
      border: 1px solid rgba(255,255,255,0.12) !important;
      border-radius: 15px !important;
      backdrop-filter: blur(14px) !important;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4) !important;
      text-align: center !important;
      max-height: 95vh !important;
      overflow-y: auto !important;
    }

    body.page3 h1 {
      color: #ffaad5 !important;
      font-size: 1.3rem !important;
      margin-bottom: 0.8rem !important;
    }

    .letter-paragraph {
      font-size: 0.8rem !important;
      line-height: 1.4 !important;
      margin-bottom: 1rem !important;
      text-align: left !important;
      color: #f1f1f1 !important;
    }

    .signature {
      font-size: 0.8rem !important;
      margin: 0.8rem 0 !important;
      color: #ffaad5 !important;
      font-style: italic !important;
    }

    /* Fixed 3D Rotating Cake */
    .cake-area {
      margin: 1.5rem 0 !important;
      display: flex !important;
      justify-content: center !important;
      align-items: center !important;
      height: 180px !important;
      perspective: 600px !important;
    }

    .cake-container {
      position: relative !important;
      width: 140px !important;
      height: 140px !important;
      transform-style: preserve-3d !important;
      animation: smoothRotate 10s linear infinite !important;
    }

    /* Stable cake base/plate */
    .cake-plate {
      position: absolute !important;
      bottom: -10px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 160px !important;
      height: 20px !important;
      background: linear-gradient(135deg, #ddd 0%, #aaa 100%) !important;
      border-radius: 50% !important;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3) !important;
    }

    /* Main cake body - simplified but effective 3D */
    .cake-body {
      position: absolute !important;
      bottom: 15px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 120px !important;
      height: 80px !important;
      background: linear-gradient(145deg, #ff6b9d 0%, #ff8f69 100%) !important;
      border-radius: 12px !important;
      box-shadow: 
        0 0 20px rgba(255, 107, 157, 0.6),
        inset 3px 3px 10px rgba(255,255,255,0.3),
        inset -3px -3px 10px rgba(0,0,0,0.2) !important;
    }

    /* Realistic icing layer */
    .icing {
      position: absolute !important;
      top: -18px !important;
      left: 0 !important;
      width: 100% !important;
      height: 25px !important;
      background: linear-gradient(135deg, #fff 0%, #f0f0f0 100%) !important;
      border-radius: 12px 12px 18px 18px !important;
      clip-path: path("M0,12 Q20,25 40,10 Q60,22 80,8 Q100,20 120,12 L120,0 L0,0 Z") !important;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2), inset 0 2px 5px rgba(255,255,255,0.8) !important;
    }

    /* Stable 3D candle */
    .candle {
      position: absolute !important;
      top: -45px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 16px !important;
      height: 40px !important;
      background: linear-gradient(135deg, #ffe066 0%, #ffd700 50%, #ffb300 100%) !important;
      border-radius: 6px !important;
      box-shadow: 
        0 0 10px rgba(255,224,102,0.6),
        inset 2px 0 4px rgba(255,255,255,0.4),
        inset -2px 0 4px rgba(0,0,0,0.2) !important;
      background-image: repeating-linear-gradient(
        45deg,
        rgba(255,123,0,0.2) 0px,
        rgba(255,123,0,0.2) 4px,
        transparent 4px,
        transparent 8px
      ) !important;
    }

    /* Realistic flame - stable animation */
    .flame {
      position: absolute !important;
      top: -22px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 14px !important;
      height: 24px !important;
      background: radial-gradient(ellipse at 30% 80%, 
        #fff176 0%, 
        #ffeb3b 25%, 
        #ff9800 50%, 
        #e65100 75%, 
        #bf360c 100%) !important;
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40% !important;
      animation: stableFlame 2s ease-in-out infinite !important;
      box-shadow: 
        0 0 20px rgba(255,241,118,0.8),
        0 0 40px rgba(255,152,0,0.4) !important;
      filter: blur(0.5px) !important;
    }

    /* Flame inner glow */
    .flame::before {
      content: '' !important;
      position: absolute !important;
      top: 2px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 8px !important;
      height: 16px !important;
      background: radial-gradient(ellipse at 30% 70%, 
        #fff9c4 0%, 
        #fff176 50%, 
        #ffb74d 100%) !important;
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40% !important;
      animation: innerGlow 2.5s ease-in-out infinite !important;
    }

    /* Smooth 360 rotation */
    @keyframes smoothRotate {
      0% { transform: rotateY(0deg) rotateX(10deg); }
      100% { transform: rotateY(360deg) rotateX(10deg); }
    }

    /* Stable flame animation */
    @keyframes stableFlame {
      0%, 100% { 
        transform: translateX(-50%) scale(1) rotate(-1deg);
        background: radial-gradient(ellipse at 30% 80%, #fff176 0%, #ffeb3b 25%, #ff9800 50%, #e65100 75%, #bf360c 100%);
      }
      25% { 
        transform: translateX(-50%) scale(1.05) rotate(1deg);
        background: radial-gradient(ellipse at 25% 75%, #fff59d 0%, #ffc107 30%, #ff7043 55%, #d84315 80%, #a5000a 100%);
      }
      50% { 
        transform: translateX(-50%) scale(0.95) rotate(-0.5deg);
        background: radial-gradient(ellipse at 35% 85%, #ffecb3 0%, #ffab40 20%, #f57c00 45%, #e53935 70%, #b71c1c 100%);
      }
      75% { 
        transform: translateX(-50%) scale(1.02) rotate(0.5deg);
        background: radial-gradient(ellipse at 40% 70%, #fff8e1 0%, #ffd54f 25%, #ff8f00 50%, #ff5722 75%, #d32f2f 100%);
      }
    }

    /* Inner flame glow */
    @keyframes innerGlow {
      0%, 100% { 
        transform: translateX(-50%) scale(1);
        opacity: 0.9;
      }
      50% { 
        transform: translateX(-50%) scale(1.1);
        opacity: 1;
      }
    }

    /* Gift Card Styling */
    .giftcard {
      margin: 1.2rem auto !important;
      display: block !important;
      width: 220px !important;
      height: 120px !important;
      cursor: pointer !important;
      position: relative !important;
      perspective: 1000px !important;
    }

    .card-box {
      width: 100% !important;
      height: 100% !important;
      position: relative !important;
      transform-style: preserve-3d !important;
      transition: transform 0.8s ease !important;
    }

    .giftcard.flipped .card-box {
      transform: rotateY(180deg) !important;
    }

    .card-front, .card-back {
      position: absolute !important;
      width: 100% !important;
      height: 100% !important;
      backface-visibility: hidden !important;
      border-radius: 15px !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      flex-direction: column !important;
      padding: 1rem !important;
      text-align: center !important;
      box-shadow: 0 6px 20px rgba(0,0,0,0.3) !important;
    }

    .card-front {
      background: linear-gradient(135deg, #ff6ec7, #ffc0cb) !important;
      color: white !important;
      font-weight: bold !important;
      font-size: 1.1rem !important;
    }

    .card-back {
      background: linear-gradient(135deg, #fff, #f8f8f8) !important;
      color: #333 !important;
      transform: rotateY(180deg) !important;
      font-size: 0.75rem !important;
      line-height: 1.3 !important;
    }

    .food-btn {
      margin-top: 0.8rem !important;
      padding: 0.7rem 1.2rem !important;
      background: linear-gradient(45deg, #ff6ec7, #ffc0cb) !important;
      color: white !important;
      border: none !important;
      border-radius: 20px !important;
      font-size: 0.85rem !important;
      font-weight: 600 !important;
      cursor: pointer !important;
      width: 90% !important;
      min-height: 44px !important;
      box-shadow: 0 4px 15px rgba(255, 110, 199, 0.3) !important;
      transition: all 0.3s ease !important;
      font-family: 'Poppins', sans-serif !important;
    }

    .food-btn:hover, .food-btn:active {
      transform: translateY(-1px) !important;
      box-shadow: 0 6px 20px rgba(255, 110, 199, 0.5) !important;
      background: linear-gradient(45deg, #ffc0cb, #ff6ec7) !important;
    }

    /* Hearts */
    body.page3 .heart {
      position: fixed !important;
      top: -10% !important;
      color: rgba(255, 105, 180, 0.4) !important;
      animation: fall linear infinite !important;
      font-size: 1rem !important;
      z-index: 1 !important;
      pointer-events: none !important;
    }

    @keyframes fall {
      0% { transform: translateY(0) rotate(0deg); opacity: 0.4; }
      100% { transform: translateY(110vh) rotate(360deg); opacity: 0; }
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Mobile Optimizations */
    @media (max-width: 768px) {
      .cake-container {
        width: 110px !important;
        height: 110px !important;
      }
      
      .cake-body {
        width: 90px !important;
        height: 60px !important;
      }
      
      .cake-plate {
        width: 120px !important;
        height: 15px !important;
      }
      
      .candle {
        width: 12px !important;
        height: 30px !important;
        top: -35px !important;
      }
      
      .flame {
        width: 10px !important;
        height: 18px !important;
        top: -18px !important;
      }
      
      .icing {
        height: 18px !important;
        top: -14px !important;
      }
    }
  </style>
</head>

<body class="page3">
  <div class="heart" style="left: 10%; animation-duration: 3s;">üíñ</div>
  <div class="heart" style="left: 70%; animation-duration: 4s; animation-delay: 2s;">üíï</div>

  <div class="letter-wrapper">
    <h1>Final Letter to You</h1>
    
    <p class="letter-paragraph">
      Somuu, I may never find enough words to measure what your existence does to my world. Kuch gift surprise krna tha mujhe aise sukha sukha wish krna psnd nahi. Fir bhi I tried doing my best, kyuki kuch toh special krna tha na somuuuuu. May all ur wishes come true, May u achieve all the success.‚ô•Ô∏è
    </p>

    <!-- Fixed 3D Rotating Cake -->
    <div class="cake-area">
      <div class="cake-container">
        <div class="cake-plate"></div>
        <div class="cake-body">
          <div class="icing"></div>
          <div class="candle">
            <div class="flame"></div>
          </div>
        </div>
      </div>
    </div>

    <p class="letter-paragraph">
      If time ever lets us rewrite chapters, know that I'll start with the line where we laughed at 6-7am videocalls jab tum ready hoti thi. (Ekdum cutu lagti thiii) Umm, maybe vo time kabhi wapis ni aaye but vo mere bestest the. Also I'm very bad in paragraphs, baaki toh tumhe pata he hain kya feel krra hu.
    </p>

    <p class="signature">-Always Here For You, Shah.</p>

    <div class="giftcard" id="giftCard">
      <div class="card-box">
        <div class="card-front">
          üéÅ<br>
          <strong>Tap to Open</strong>
        </div>
        <div class="card-back">
          <div style="margin-bottom: .8rem; font-size: .75rem; line-height: 1.3;">
            Thank you for painting my ordinary days with colors I didn't know existed.<br>
            No matter how pages turn, those hues will stay vivid forever. üíú
          </div>
          <button class="food-btn" id="foodButton">
            Suno, Idhar Click Karna üò∂
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const giftCard = document.getElementById('giftCard');
    const foodButton = document.getElementById('foodButton');

    giftCard.addEventListener('click', function(e) {
      if (e.target.id !== 'foodButton') {
        this.classList.toggle('flipped');
      }
    });
    
    foodButton.addEventListener('click', function(e) {
      e.stopPropagation();
      window.location.href = 'page4.html';
    });
    
    foodButton.addEventListener('touchstart', function(e) {
      e.stopPropagation();
      e.preventDefault();
      window.location.href = 'page4.html';
    });
    
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function(event) {
      const now = (new Date()).getTime();
      if (now - lastTouchEnd <= 300) {
        event.preventDefault();
      }
      lastTouchEnd = now;
    }, { passive: false });
  </script>
</body>
</html>
