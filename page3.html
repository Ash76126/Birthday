<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Final Letter üéÇüíù</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">

  <style>
    /* Page 3 base styles */
    body.page3 {
      background: linear-gradient(135deg, #12002f 0%, #000 40%, #12002f 100%) !important;
      background-size: 400% 400% !important;
      animation: gradientShift 10s ease infinite !important;
      color: #fff !important;
      font-family: 'Poppins', sans-serif !important;
      padding: 1rem !important;
      overflow-y: auto !important;
      overflow-x: hidden !important;
      height: 100vh !important;
      width: 100vw !important;
      display: flex !important;
      align-items: flex-start !important;
      justify-content: center !important;
      padding-top: 1rem !important;
    }

    .letter-wrapper {
      max-width: 500px !important;
      width: 95% !important;
      padding: 1.5rem 1rem !important;
      background: rgba(255,255,255,0.08) !important;
      border: 1px solid rgba(255,255,255,0.12) !important;
      border-radius: 15px !important;
      backdrop-filter: blur(14px) !important;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4) !important;
      text-align: center !important;
      max-height: 95vh !important;
      overflow-y: auto !important;
    }

    body.page3 h1 {
      color: #ffaad5 !important;
      font-size: 1.3rem !important;
      margin-bottom: 0.8rem !important;
      font-family: 'Playfair Display', serif !important;
    }

    .letter-paragraph {
      font-size: 0.85rem !important;
      line-height: 1.5 !important;
      margin-bottom: 1rem !important;
      text-align: left !important;
      color: #f1f1f1 !important;
    }

    .signature {
      font-size: 0.85rem !important;
      margin: 0.8rem 0 !important;
      color: #ffaad5 !important;
      font-style: italic !important;
    }

    /* Enhanced 3D Rotating Cake */
    .cake-area {
      margin: 1.8rem 0 !important;
      display: flex !important;
      justify-content: center !important;
      align-items: center !important;
      perspective: 800px !important;
      height: 200px !important;
    }

    .cake-container {
      position: relative !important;
      width: 150px !important;
      height: 150px !important;
      transform-style: preserve-3d !important;
      animation: smoothRotate 12s linear infinite !important;
    }

    /* Cake Base (Plate) */
    .cake-plate {
      position: absolute !important;
      bottom: -15px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 170px !important;
      height: 25px !important;
      border-radius: 50% !important;
      background: linear-gradient(135deg, #e8e8e8, #b8b8b8) !important;
      box-shadow: 
        0 5px 15px rgba(0,0,0,0.3),
        inset 0 2px 5px rgba(255,255,255,0.5),
        inset 0 -2px 5px rgba(0,0,0,0.2) !important;
    }

    /* Main Cake Body */
    .cake-body {
      position: absolute !important;
      bottom: 20px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 125px !important;
      height: 85px !important;
      border-radius: 15px !important;
      background: linear-gradient(145deg, #ff6b9d, #ff8f69) !important;
      box-shadow: 
        0 0 25px rgba(255, 107, 157, 0.7),
        inset 0 4px 12px rgba(255,255,255,0.3),
        inset 0 -4px 12px rgba(0,0,0,0.2),
        0 12px 25px rgba(0,0,0,0.4) !important;
      position: relative !important;
      overflow: hidden !important;
    }

    /* Cake Side Highlights */
    .cake-body::before {
      content: '' !important;
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      width: 18px !important;
      height: 100% !important;
      background: linear-gradient(90deg, rgba(255,255,255,0.4), transparent) !important;
      border-radius: 15px 0 0 15px !important;
    }

    .cake-body::after {
      content: '' !important;
      position: absolute !important;
      top: 0 !important;
      right: 0 !important;
      width: 18px !important;
      height: 100% !important;
      background: linear-gradient(270deg, rgba(0,0,0,0.3), transparent) !important;
      border-radius: 0 15px 15px 0 !important;
    }

    /* Realistic Icing */
    .icing {
      position: absolute !important;
      top: -22px !important;
      left: 0 !important;
      width: 100% !important;
      height: 30px !important;
      background: linear-gradient(135deg, #fff, #f5f5f5) !important;
      border-radius: 15px 15px 20px 20px !important;
      clip-path: path("M0,18 Q12,30 28,16 Q45,28 65,14 Q85,26 105,18 Q115,30 125,18 L125,0 L0,0 Z") !important;
      box-shadow: 
        0 3px 12px rgba(0,0,0,0.2),
        inset 0 2px 8px rgba(255,255,255,0.8),
        inset 0 -2px 8px rgba(0,0,0,0.1) !important;
    }

    /* Enhanced Candle */
    .candle {
      position: absolute !important;
      top: -50px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 18px !important;
      height: 45px !important;
      border-radius: 8px !important;
      background: linear-gradient(135deg, #ffe066 0%, #ffd700 50%, #ffb300 100%) !important;
      background-image: 
        repeating-linear-gradient(45deg, 
          rgba(255,123,0,0.3) 0, rgba(255,123,0,0.3) 4px, 
          transparent 4px, transparent 8px),
        linear-gradient(90deg, rgba(255,255,255,0.4) 0%, transparent 30%, transparent 70%, rgba(0,0,0,0.2) 100%) !important;
      box-shadow: 
        0 0 15px rgba(255,224,102,0.8),
        inset 2px 0 5px rgba(255,255,255,0.5),
        inset -2px 0 5px rgba(0,0,0,0.2) !important;
    }

    /* Realistic Flame */
    .flame {
      position: absolute !important;
      top: -28px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 16px !important;
      height: 26px !important;
      border-radius: 50% 50% 50% 50%/60% 60% 40% 40% !important;
      background: radial-gradient(ellipse at 30% 80%, #ffed4e 0%, #ff6b35 30%, #d73502 60%, #ad2d07 100%) !important;
      filter: blur(0.6px) !important;
      animation: realisticFlame 1.8s infinite ease-in-out !important;
      box-shadow: 
        0 0 25px rgba(255,237,78,0.9),
        0 0 50px rgba(255,107,53,0.6),
        0 0 75px rgba(215,53,2,0.3) !important;
    }

    /* Inner Flame */
    .flame::before {
      content: '' !important;
      position: absolute !important;
      top: 3px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 9px !important;
      height: 16px !important;
      border-radius: 50% 50% 50% 50%/60% 60% 40% 40% !important;
      background: radial-gradient(ellipse at 30% 70%, #fff5b7 0%, #ffed4e 40%, #ff9500 80%) !important;
      animation: innerFlame 2.1s infinite ease-in-out !important;
    }

    /* Copy Button */
    .copy-btn {
      position: fixed !important;
      top: 20px !important;
      right: 20px !important;
      padding: 0.6rem 1rem !important;
      background: linear-gradient(45deg, #ff6ec7, #ffc0cb) !important;
      color: white !important;
      border: none !important;
      border-radius: 20px !important;
      font-size: 0.8rem !important;
      font-weight: 600 !important;
      cursor: pointer !important;
      box-shadow: 0 4px 15px rgba(255, 110, 199, 0.3) !important;
      transition: all 0.3s ease !important;
      z-index: 100 !important;
      font-family: 'Poppins', sans-serif !important;
    }

    .copy-btn:hover, .copy-btn:active {
      transform: translateY(-2px) !important;
      box-shadow: 0 6px 20px rgba(255, 110, 199, 0.5) !important;
    }

    .copy-btn.copied {
      background: linear-gradient(45deg, #4caf50, #81c784) !important;
    }

    /* Animations */
    @keyframes smoothRotate {
      0% { transform: rotateY(0deg) rotateX(12deg); }
      100% { transform: rotateY(360deg) rotateX(12deg); }
    }

    @keyframes realisticFlame {
      0%, 100% { 
        transform: translateX(-50%) scale(1) rotate(-2deg) scaleY(1);
        background: radial-gradient(ellipse at 30% 80%, #ffed4e 0%, #ff6b35 30%, #d73502 60%, #ad2d07 100%);
      }
      20% { 
        transform: translateX(-50%) scale(1.05) rotate(1deg) scaleY(1.1);
        background: radial-gradient(ellipse at 25% 75%, #fff176 0%, #ff7043 35%, #e53935 65%, #b71c1c 100%);
      }
      40% { 
        transform: translateX(-50%) scale(1.1) rotate(-1deg) scaleY(0.95);
        background: radial-gradient(ellipse at 35% 85%, #ffeb3b 0%, #ff5722 25%, #d32f2f 55%, #a5000a 100%);
      }
      60% { 
        transform: translateX(-50%) scale(0.95) rotate(2deg) scaleY(1.15);
        background: radial-gradient(ellipse at 40% 70%, #fff59d 0%, #ff8a65 40%, #e57373 70%, #c62828 100%);
      }
      80% { 
        transform: translateX(-50%) scale(1.08) rotate(-1.5deg) scaleY(1.05);
        background: radial-gradient(ellipse at 20% 80%, #ffecb3 0%, #ffab40 30%, #ff7043 60%, #d84315 100%);
      }
    }

    @keyframes innerFlame {
      0%, 100% { 
        transform: translateX(-50%) scale(1) rotate(1deg);
        opacity: 0.8;
      }
      33% { 
        transform: translateX(-50%) scale(1.1) rotate(-1deg);
        opacity: 0.9;
      }
      66% { 
        transform: translateX(-50%) scale(0.9) rotate(2deg);
        opacity: 1;
      }
    }

    /* Gift Card */
    .giftcard {
      margin: 1.2rem auto !important;
      display: block !important;
      width: 230px !important;
      height: 130px !important;
      cursor: pointer !important;
      position: relative !important;
      perspective: 1000px !important;
    }

    .card-box {
      width: 100% !important;
      height: 100% !important;
      position: relative !important;
      transform-style: preserve-3d !important;
      transition: transform 0.8s ease !important;
    }

    .giftcard.flipped .card-box {
      transform: rotateY(180deg) !important;
    }

    .card-front, .card-back {
      position: absolute !important;
      width: 100% !important;
      height: 100% !important;
      backface-visibility: hidden !important;
      border-radius: 16px !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      flex-direction: column !important;
      padding: 1rem !important;
      text-align: center !important;
      box-shadow: 0 6px 20px rgba(0,0,0,0.3) !important;
    }

    .card-front {
      background: linear-gradient(135deg, #ff6ec7, #ffc0cb) !important;
      color: white !important;
      font-weight: bold !important;
      font-size: 1.1rem !important;
    }

    .card-back {
      background: linear-gradient(135deg, #fff, #f8f8f8) !important;
      color: #333 !important;
      transform: rotateY(180deg) !important;
      font-size: 0.8rem !important;
      line-height: 1.4 !important;
    }

    .food-btn {
      margin-top: 0.8rem !important;
      padding: 0.7rem 1.2rem !important;
      background: linear-gradient(45deg, #ff6ec7, #ffc0cb) !important;
      color: white !important;
      border: none !important;
      border-radius: 20px !important;
      font-size: 0.9rem !important;
      font-weight: 600 !important;
      cursor: pointer !important;
      width: 92% !important;
      min-height: 44px !important;
      box-shadow: 0 4px 15px rgba(255, 110, 199, 0.3) !important;
      transition: all 0.3s ease !important;
      font-family: 'Poppins', sans-serif !important;
    }

    .food-btn:hover, .food-btn:active {
      transform: translateY(-1px) !important;
      box-shadow: 0 6px 20px rgba(255, 110, 199, 0.5) !important;
      background: linear-gradient(45deg, #ffc0cb, #ff6ec7) !important;
    }

    /* Hearts */
    body.page3 .heart {
      position: fixed !important;
      top: -10% !important;
      color: rgba(255, 105, 180, 0.4) !important;
      animation: fall linear infinite !important;
      font-size: 1rem !important;
      z-index: 1 !important;
      pointer-events: none !important;
    }

    @keyframes fall {
      0% { transform: translateY(0) rotate(0deg); opacity: 0.4; }
      100% { transform: translateY(110vh) rotate(360deg); opacity: 0; }
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Mobile Optimizations */
    @media (max-width: 768px) {
      .cake-container {
        width: 120px !important;
        height: 120px !important;
      }
      
      .cake-body {
        width: 100px !important;
        height: 70px !important;
      }
      
      .cake-plate {
        width: 140px !important;
        height: 20px !important;
      }
      
      .candle {
        width: 14px !important;
        height: 35px !important;
        top: -40px !important;
      }
      
      .flame {
        width: 12px !important;
        height: 20px !important;
        top: -22px !important;
      }
      
      .icing {
        height: 22px !important;
        top: -16px !important;
      }
      
      .copy-btn {
        top: 15px !important;
        right: 15px !important;
        padding: 0.5rem 0.8rem !important;
        font-size: 0.75rem !important;
      }
      
      .giftcard {
        width: 220px !important;
        height: 120px !important;
      }
    }
  </style>
</head>

<body class="page3">
  <!-- Copy Button -->
  <button class="copy-btn" id="copyBtn" onclick="copyLetter()">üìÑ Copy Text</button>
  
  <!-- Floating hearts -->
  <div class="heart" style="left: 10%; animation-duration: 3.5s;">üíñ</div>
  <div class="heart" style="left: 70%; animation-duration: 4.2s; animation-delay: 1.8s;">üíï</div>

  <div class="letter-wrapper">
    <h1>Final Letter to You</h1>
    
    <p class="letter-paragraph">
      Somuu, I may never find enough words to measure what your existence does to my world. Kuch gift surprise krna tha mujhe aise sukha sukha wish krna psnd nahi. Fir bhi I tried doing my best, kyuki kuch toh special krna tha na somuuuuu. May all ur wishes come true, May u achieve all the success. ‚ô•Ô∏è
    </p>

    <!-- Enhanced 3D Rotating Cake -->
    <div class="cake-area">
      <div class="cake-container">
        <div class="cake-plate"></div>
        <div class="cake-body">
          <div class="icing"></div>
          <div class="candle">
            <div class="flame"></div>
          </div>
        </div>
      </div>
    </div>

    <p class="letter-paragraph">
      If time ever lets us rewrite chapters, know that I'll start with the line where we laughed at 6-7am videocalls jab tum ready hoti thi. (Ekdum cutu lagti thiii) Umm, maybe vo time kabhi wapis ni aaye but vo mere bestest the. Also I'm very bad in paragraphs, baaki toh tumhe pata he hain kya feel krra hu.
    </p>

    <p class="signature">-Always Here For You, Shah.</p>

    <!-- Gift Card -->
    <div class="giftcard" id="giftCard">
      <div class="card-box">
        <div class="card-front">
          üéÅ<br>
          <strong>Tap to Open</strong>
        </div>
        <div class="card-back">
          <div style="margin-bottom: .8rem;">
            Thank you for painting my ordinary days with colors I didn't know existed.<br>
            No matter how pages turn, those hues will stay vivid forever. üíú
          </div>
          <button class="food-btn" id="foodButton">
            Suno, Idhar Click Karna üò∂
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Copy letter functionality
    function copyLetter() {
      const letterText = `Final Letter to You

Somuu, I may never find enough words to measure what your existence does to my world. Kuch gift surprise krna tha mujhe aise sukha sukha wish krna psnd nahi. Fir bhi I tried doing my best, kyuki kuch toh special krna tha na somuuuuu. May all ur wishes come true, May u achieve all the success. ‚ô•Ô∏è

If time ever lets us rewrite chapters, know that I'll start with the line where we laughed at 6-7am videocalls jab tum ready hoti thi. (Ekdum cutu lagti thiii) Umm, maybe vo time kabhi wapis ni aaye but vo mere bestest the. Also I'm very bad in paragraphs, baaki toh tumhe pata he hain kya feel krra hu.

-Always Here For You, Shah.`;

      const copyBtn = document.getElementById('copyBtn');
      
      // Try modern clipboard API first
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(letterText).then(() => {
          showCopySuccess(copyBtn);
        }).catch(() => {
          fallbackCopy(letterText, copyBtn);
        });
      } else {
        fallbackCopy(letterText, copyBtn);
      }
    }

    // Fallback copy method
    function fallbackCopy(text, btn) {
      const textArea = document.createElement('textarea');
      textArea.value = text;
      textArea.style.position = 'fixed';
      textArea.style.opacity = '0';
      document.body.appendChild(textArea);
      textArea.focus();
      textArea.select();
      
      try {
        document.execCommand('copy');
        showCopySuccess(btn);
      } catch (err) {
        btn.textContent = '‚ùå Copy Failed';
        setTimeout(() => btn.textContent = 'üìÑ Copy Text', 2000);
      }
      
      document.body.removeChild(textArea);
    }

    // Show copy success feedback
    function showCopySuccess(btn) {
      btn.textContent = '‚úÖ Copied!';
      btn.classList.add('copied');
      setTimeout(() => {
        btn.textContent = 'üìÑ Copy Text';
        btn.classList.remove('copied');
      }, 2000);
    }

    // Gift card and navigation functionality
    const giftCard = document.getElementById('giftCard');
    const foodButton = document.getElementById('foodButton');

    giftCard.addEventListener('click', function(e) {
      if (e.target.id !== 'foodButton') {
        this.classList.toggle('flipped');
      }
    });
    
    foodButton.addEventListener('click', function(e) {
      e.stopPropagation();
      window.location.href = 'page4.html';
    });
    
    foodButton.addEventListener('touchstart', function(e) {
      e.stopPropagation();
      e.preventDefault();
      window.location.href = 'page4.html';
    });
    
    // Prevent zoom on double tap
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function(event) {
      const now = (new Date()).getTime();
      if (now - lastTouchEnd <= 300) {
        event.preventDefault();
      }
      lastTouchEnd = now;
    }, { passive: false });
  </script>
</body>
</html>
